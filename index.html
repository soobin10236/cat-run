<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cat Run Game</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
    <div id="ds-container">
        <!-- 1. Top Screen: Game Display -->
        <div id="screen-area">
            <div id="game-container">
                <canvas id="game-canvas" width="800" height="400"></canvas>
            </div>

            <!-- UI Overlay -->
            <div id="ui-layer">
                <div id="score-board">
                    점수: <span id="score-value">0</span>
                    <br>
                    거리: <span id="distance-value">0</span>m
                </div>
                <div id="game-version">v1.5.0</div>

                <!-- Top Right Buttons -->
                <div class="top-right-controls">
                    <button id="pause-btn">⏸️</button>
                    <button id="mute-btn">🔊</button>
                    <button id="feedback-btn">✉️</button>
                </div>

                <!-- 상위 % 표시 -->
                <!-- <div id="percentile-container" class="percentile-container hidden">
                    <p class="percentile-text">상위 <span id="percentile-value">--</span>%</p>
                    <div class="percentile-bar-box">
                        <div class="percentile-bar-bg"></div>
                        <div id="percentile-marker" class="percentile-marker">▼</div>
                    </div>
                </div> -->
            </div>

            <!-- Start Screen -->
            <div id="start-screen" class="ui-screen">
                <h1>🐱 Cat Run 😻</h1>
                <!-- <p>장애물을 넘고 아이템을 획득하세요!</p> -->
                <div class="button-group">
                    <button id="start-btn" class="pixel-btn">😺게임 시작</button>
                    <button id="show-leaderboard-start-btn" class="pixel-btn secondary-btn">🏆랭킹</button>
                    <button id="group-btn" class="pixel-btn group-btn">👥그룹</button>
                </div>
            </div>

            <!-- Game Over Screen -->
            <div id="game-over-screen" class="hidden ui-screen">
                <h1>점수: <span id="final-score">0</span></h1>
                <!-- 상위 % 표시 -->
                <div id="percentile-container" class="percentile-container hidden">
                    <p class="percentile-text">전체 상위 <span id="percentile-value">--</span>%</p>
                    <div class="percentile-bar-box">
                        <div class="percentile-bar-bg"></div>
                        <div id="percentile-marker" class="percentile-marker">▼</div>
                    </div>
                </div>

                <div class="button-container button-grid">
                    <button id="restart-btn" class="pixel-btn">😺재시작</button>
                    <button id="share-btn" class="pixel-btn secondary-btn" style="background-color: #9b59b6;">🔗
                        공유</button>
                    <button id="show-leaderboard-btn" class="pixel-btn secondary-btn">🏆 랭킹</button>
                    <button id="group-btn-gameover" class="pixel-btn group-btn">👥그룹</button>
                </div>
            </div>

            <!-- Pause Overlay -->
            <div id="pause-overlay" class="hidden ui-screen">
                <h1>⏸️ 일시 정지</h1>
                <button id="resume-btn" class="pixel-btn">계속 하기</button>
                <p>'P'를 눌러 계속하기</p>
            </div>

            <!-- Leaderboard Screen -->
            <div id="leaderboard-screen" class="hidden ui-screen">
                <br />
                <h1>🏆 명예의 전당 🏆</h1>
                <div id="leaderboard-filter" style="margin-bottom: 10px;">
                    <button id="filter-global-btn" class="pixel-btn filter-btn active"
                        style="width: auto; display: inline-block;">전체</button>
                    <button id="filter-group-btn" class="pixel-btn filter-btn"
                        style="width: auto; display: inline-block;">그룹</button>
                </div>
                <div class="leaderboard-container">
                    <table id="leaderboard-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Name</th>
                                <th>Score</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <tr>
                                <td colspan="4">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <button id="leaderboard-close-btn" class="pixel-btn secondary-btn">닫기</button>
            </div>

            <!-- Group Modal -->
            <div id="group-modal" class="hidden ui-screen">
                <div class="modal-content">
                    <h2>👥 그룹</h2>
                    <div id="group-status-area">
                        <p>현재 그룹: <span id="current-group-id" style="font-weight: bold; color: #e67e22;">없음</span></p>
                        <div id="group-buttons-area" class="hidden">
                            <button id="copy-group-code-btn" class="pixel-btn secondary-btn">📋 그룹 코드 복사</button>
                            <button id="copy-invite-link-btn" class="pixel-btn group-btn">🔗 초대 링크 복사</button>
                        </div>
                        <button id="leave-group-btn" class="pixel-btn hidden" style="background-color: #c0392b;">그룹
                            나가기</button>
                    </div>

                    <div id="group-action-area">
                        <button id="create-group-btn" class="pixel-btn">새 그룹 생성</button>
                        <div style="margin: 10px 0; font-weight: bold; color: #7f8c8d;">- OR -</div>
                        <input type="text" id="group-code-input" placeholder="참여 코드 (6자리)" maxlength="6"
                            style="text-transform: uppercase;">
                        <button id="join-group-btn" class="pixel-btn secondary-btn">그룹 참여</button>
                    </div>
                    <button id="close-group-modal-btn" class="pixel-btn secondary-btn"
                        style="margin-top: 15px;">닫기</button>
                </div>
            </div>

            <!-- Name Input Modal -->
            <div id="name-input-modal" class="hidden ui-screen">
                <div class="modal-content">
                    <p>🎉 신기록 달성! 🎉</p>
                    <p>등록할 이름을 입력하세요🤩</p>
                    <input type="text" id="player-name-input" placeholder="이름 (최대 10자)" maxlength="10">
                    <button id="submit-score-btn" class="pixel-btn">등록</button>
                </div>
            </div>

            <!-- Feedback Modal -->
            <div id="feedback-modal" class="hidden ui-screen">
                <div class="modal-content">
                    <h2>개발자에게 메시지 보내기</h2>
                    <p>버그 제보, 건의 사항 등 자유롭게 남겨주세요!</p>
                    <textarea id="feedback-input" placeholder="내용을 입력하세요..." rows="5" maxlength="500"></textarea>
                    <div class="button-group">
                        <button id="send-feedback-btn" class="pixel-btn">보내기</button>
                        <button id="close-feedback-btn" class="pixel-btn secondary-btn">닫기</button>
                    </div>
                </div>
            </div>

            <!-- Patch Notes Modal -->
            <div id="patch-notes-modal" class="hidden ui-screen">
                <div class="modal-content patch-notes-content">
                    <h2>📢 패치 노트 (v1.5.0)</h2>
                    <div class="patch-list">
                        <h3>✨ 새로운 기능</h3>
                        <ul>
                            <li><strong>👥 그룹 플레이:</strong> 친구들과 그룹을 만들어 경쟁하세요!</li>
                            <li><strong>📤 도전장 공유:</strong> 내 점수를 친구에게 자랑해보세요.</li>
                            <li><strong>📱 UI 개편:</strong> 닌텐도 DS 스타일의 새로운 레이아웃!</li>
                        </ul>
                        <h3>🛠️ 개선 사항</h3>
                        <ul>
                            <li><strong>🛡️ 쉴드 아이템:</strong> 최대 3개 중첩! 장애물을 막아줍니다.</li>
                            <li><strong>✨ 일시 무적:</strong> 방어 후 잠시 동안 무적 상태가 됩니다.</li>
                        </ul>
                    </div>
                    <div class="patch-footer">
                        <label>
                            <input type="checkbox" id="dont-show-again-checkbox">
                            다시 보지 않기
                        </label>
                        <button id="close-patch-notes-btn" class="pixel-btn secondary-btn"
                            style="width: auto; padding: 5px 10px;">닫기</button>
                    </div>
                </div>
            </div>
        </div> <!-- End of screen-area -->

        <!-- 2. Middle Screen: Controls -->
        <div id="controls-area">
            <div class="control-group left">
                <button id="jump-btn" class="game-btn jump">
                    <span class="btn-label">JUMP</span>
                    <span class="btn-key">↑</span>
                </button>
            </div>
            <div class="control-group right">
                <button id="slide-btn" class="game-btn slide">
                    <span class="btn-label">SLIDE</span>
                    <span class="btn-key">↓</span>
                </button>
            </div>
        </div>

        <!-- 3. Bottom Screen: Ads -->
        <div id="ad-area">
            <div class="ad-placeholder">
                <span>플레이해주셔서 감사합니다.🙏</span>
            </div>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
</body>

</html>